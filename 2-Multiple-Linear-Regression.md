# 2 å¤šå…ƒçº¿æ€§å›å½’

## 1. ç®€ä»‹

å¤šå…ƒçº¿æ€§å›å½’æ˜¯ä¸€ç§ç»Ÿè®¡å»ºæ¨¡æ–¹æ³•ï¼Œç”¨äºç ”ç©¶å¤šä¸ªè‡ªå˜é‡ä¸ä¸€ä¸ªå› å˜é‡ä¹‹é—´çš„å…³ç³»ã€‚å®ƒæ˜¯ç®€å•çº¿æ€§å›å½’çš„æ‰©å±•ï¼Œç®€å•çº¿æ€§å›å½’åªæ¶‰åŠä¸€ä¸ªè‡ªå˜é‡å’Œä¸€ä¸ªå› å˜é‡ã€‚åœ¨å¤šå…ƒçº¿æ€§å›å½’ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªè‡ªå˜é‡æ¥é¢„æµ‹ä¸€ä¸ªå› å˜é‡ã€‚

å¤šå…ƒçº¿æ€§å›å½’çš„åŸºæœ¬åŸç†æ˜¯é€šè¿‡æ‹Ÿåˆä¸€ä¸ªçº¿æ€§æ¨¡å‹æ¥æè¿°è‡ªå˜é‡ä¸å› å˜é‡ä¹‹é—´çš„å…³ç³»ã€‚è¿™ä¸ªçº¿æ€§æ¨¡å‹é€šå¸¸é‡‡ç”¨æœ€å°äºŒä¹˜æ³•æ¥ä¼°è®¡å‚æ•°ï¼Œä½¿å¾—æ¨¡å‹é¢„æµ‹å€¼ä¸å®é™…è§‚æµ‹å€¼ä¹‹é—´çš„æ®‹å·®å¹³æ–¹å’Œæœ€å°åŒ–ã€‚

å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹çš„ä¸€èˆ¬å½¢å¼å¯ä»¥è¡¨ç¤ºä¸ºï¼š

$y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_n x_n + \epsilon$

å…¶ä¸­ï¼Œ$y$ æ˜¯å› å˜é‡ï¼Œ$x_1, x_2, ..., x_n$ æ˜¯è‡ªå˜é‡ï¼Œ$\beta_0, \beta_1, ..., \beta_n$ æ˜¯å›å½’ç³»æ•°ï¼Œ$\epsilon$ æ˜¯è¯¯å·®é¡¹ã€‚

é€šè¿‡å¤šå…ƒçº¿æ€§å›å½’åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šè‡ªå˜é‡ä¸å› å˜é‡ä¹‹é—´çš„å…³ç³»å¼ºåº¦å’Œæ–¹å‘ï¼Œå¹¶ä¸”å¯ä»¥å¯¹å› å˜é‡è¿›è¡Œé¢„æµ‹å’Œè§£é‡Šã€‚

## 2. ä¾‹å­ä¸åº•å±‚çš„æ‰‹åŠ¨å®ç°

### 2.1 ç›®æ ‡

å‡è®¾æˆ‘ä»¬æƒ³è¦é¢„æµ‹ä¸€ä¸ªäººçš„ä½“é‡ï¼ˆå› å˜é‡ï¼‰åŸºäºä»–ä»¬çš„èº«é«˜ã€å¹´é¾„å’Œæ€§åˆ«ï¼ˆè‡ªå˜é‡ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥æ”¶é›†ä¸€ç»„æ•°æ®ï¼ŒåŒ…æ‹¬è®¸å¤šäººçš„èº«é«˜ã€å¹´é¾„ã€æ€§åˆ«å’Œç›¸åº”çš„ä½“é‡ã€‚

æ•°æ®å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

| èº«é«˜(cm) | å¹´é¾„ï¼ˆå²ï¼‰ | æ€§åˆ« | ä½“é‡ï¼ˆkgï¼‰ |
| -------- | ---------- | ---- | ---------- |
| 170      | 30         | ç”·   | 75         |
| 160      | 45         | å¥³   | 65         |
| 180      | 25         | ç”·   | 85         |
| 165      | 35         | å¥³   | 70         |
| ...      | ...        | ...  | ...        |

æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å»ºç«‹ä¸€ä¸ªå¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹ï¼Œä»¥ä¾¿åŸºäºèº«é«˜ã€å¹´é¾„å’Œæ€§åˆ«**æ¥é¢„æµ‹ä½“é‡**ã€‚

### 2.2 é€‰æ‹©æ¨¡å‹â€”â€”å¤šå…ƒçº¿æ€§æ¨¡å‹

å‡è®¾æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å½¢å¼çš„çº¿æ€§æ¨¡å‹ï¼š

$ä½“é‡ = \beta_0 + \beta_1 \times èº«é«˜ + \beta_2 \times å¹´é¾„ + \beta_3 \times æ€§åˆ«$

å…¶ä¸­ï¼Œ$\beta_0, \beta_1, \beta_2, \beta_3$â€‹ æ˜¯æ¨¡å‹çš„ç³»æ•°ï¼ˆå‚æ•°ï¼‰ï¼Œè€Œèº«é«˜ã€å¹´é¾„å’Œæ€§åˆ«æ˜¯è‡ªå˜é‡ã€‚

ç°åœ¨æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯æ±‚è§£æœ€åˆé€‚çš„å‚æ•°ã€‚

### 2.3 å¦‚ä½•æ±‚è§£å‚æ•°

##### é‚£ä¹ˆå¦‚ä½•é€‰æ‹©åˆé€‚çš„å‚æ•°å‘¢ï¼Ÿ

è¿™å°±éœ€è¦æŒ‡å®šä¸€ä¸ªè§„åˆ™ï¼š

- è¿™ä¸ªè§„åˆ™è¦æ»¡è¶³åœ¨å‚æ•°æœ€å¥½çš„æƒ…å†µä¸‹ï¼Œè§„åˆ™ä½“ç°ä¹Ÿæœ€å¥½
- å¯¹äºå‚æ•°è®¾ç½®ä¸å¥½çš„æƒ…å†µï¼Œé‚£ä¹ˆè§„åˆ™ä¹Ÿå¯¹åº”å·®

è¿™ä¸ªè§„åˆ™æˆ‘ä»¬å°±ç§°ä¹‹ä¸º**æŸå¤±å‡½æ•°**ã€‚

åœ¨å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹ä¸­ï¼ŒæŸå¤±å‡½æ•°ï¼ˆæˆ–æˆæœ¬å‡½æ•°ï¼‰æ˜¯**è¡¡é‡æ¨¡å‹é¢„æµ‹å€¼ä¸å®é™…è§‚æµ‹å€¼ä¹‹é—´å·®å¼‚çš„ä¸€ä¸ªæŒ‡æ ‡ã€‚**å®ƒçš„ç›®çš„æ˜¯**é‡åŒ–æ¨¡å‹çš„é¢„æµ‹å€¼å’Œå®é™…å€¼ä¹‹é—´çš„è¯¯å·®**ã€‚å¸¸ç”¨çš„æŸå¤±å‡½æ•°æ˜¯**å¹³æ–¹è¯¯å·®æŸå¤±å‡½æ•°**ï¼Œè¿™æ˜¯å› ä¸ºå®ƒå…·æœ‰è‰¯å¥½çš„æ•°å­¦æ€§è´¨ï¼Œä½¿å¾—æ±‚è§£è¿‡ç¨‹ç›¸å¯¹ç®€å•ï¼Œå¹¶ä¸”åœ¨å¾ˆå¤šæƒ…å†µä¸‹èƒ½å¤Ÿç»™å‡ºåˆç†çš„ä¼°è®¡ç»“æœã€‚

##### å¹³æ–¹è¯¯å·®æŸå¤±å‡½æ•°

å¹³æ–¹è¯¯å·®æŸå¤±å‡½æ•°å®šä¹‰ä¸º**æ‰€æœ‰è§‚æµ‹å€¼çš„é¢„æµ‹è¯¯å·®çš„å¹³æ–¹å’Œ**ã€‚å¦‚æœæˆ‘ä»¬æœ‰ $n$ ä¸ªè§‚æµ‹å€¼ï¼Œæ¨¡å‹çš„é¢„æµ‹å€¼è¡¨ç¤ºä¸º $\hat{Y}$ï¼Œå®é™…è§‚æµ‹å€¼è¡¨ç¤ºä¸º $Y$ï¼Œé‚£ä¹ˆå¹³æ–¹è¯¯å·®æŸå¤±å‡½æ•° $S$ å¯ä»¥è¡¨ç¤ºä¸ºï¼š

$$
S = \sum_{i=1}^{n} (y_i - \hat{y}_i)^2
$$
å…¶ä¸­ï¼Œ$y_i$ æ˜¯ç¬¬ $i$ ä¸ªè§‚æµ‹çš„å®é™…å€¼ï¼Œ$\hat{y}_i$ æ˜¯æ¨¡å‹å¯¹ç¬¬ $i$ ä¸ªè§‚æµ‹çš„é¢„æµ‹å€¼ã€‚å…¶å®å°±æ˜¯æˆ‘ä»¬ä¸Šä¸€ç¯‡æ–‡ç« è®²çš„æŸå¤±å‡½æ•°ã€‚

ç°åœ¨æˆ‘ä»¬çš„ç›®çš„å°±æ˜¯æ‰¾åˆ°å¯¹åº”çš„ $\beta_0, \beta_1, \beta_2, \beta_3$ï¼Œä½¿å¾—æœ€åæ ¹æ®ä¸Šè¿°å…¬å¼è®¡ç®—çš„ç»“æœæœ€å°ã€‚

### 2.4 ä¸ºä»€ä¹ˆéœ€è¦ç”¨çŸ©é˜µè¡¨ç¤ºï¼Ÿ

çŸ©é˜µè¡¨ç¤ºåœ¨å¤šå…ƒçº¿æ€§å›å½’å’Œè®¸å¤šå…¶ä»–æ•°æ®åˆ†æã€æœºå™¨å­¦ä¹ æ–¹æ³•ä¸­è‡³å…³é‡è¦ï¼Œä¸»è¦ç”±äºä»¥ä¸‹å‡ ç‚¹åŸå› ï¼š

1. **è®¡ç®—æ•ˆç‡**

ä½¿ç”¨çŸ©é˜µè¡¨ç¤ºå¯ä»¥å……åˆ†åˆ©ç”¨ç°ä»£è®¡ç®—æœºå’Œæ•°å­¦è½¯ä»¶åº“ï¼ˆå¦‚NumPyã€MATLABï¼‰çš„é«˜æ•ˆçŸ©é˜µè¿ç®—èƒ½åŠ›ï¼Œä½¿å¾—å¯¹å¤§è§„æ¨¡æ•°æ®é›†çš„å¤„ç†æ›´åŠ å¿«é€Ÿå’Œé«˜æ•ˆã€‚çŸ©é˜µè¿ç®—å¯ä»¥**å¹¶è¡Œå¤„ç†**ï¼Œè¿™æ„å‘³ç€å¯ä»¥åŒæ—¶è®¡ç®—å¤šä¸ªæ•°æ®ç‚¹æˆ–ç‰¹å¾çš„è¿ç®—ï¼Œæ˜¾è‘—æé«˜è®¡ç®—é€Ÿåº¦ã€‚

2. **æ•°å­¦è¡¨è¾¾çš„ç®€æ´æ€§**

çŸ©é˜µè¡¨ç¤ºä½¿å¤æ‚çš„æ•°å­¦è¿ç®—å’Œæ¨¡å‹å˜å¾—æ›´åŠ ç®€æ´æ˜“æ‡‚ã€‚æ¯”å¦‚ï¼Œåœ¨å¤šå…ƒçº¿æ€§å›å½’ä¸­ï¼Œ**ä½¿ç”¨çŸ©é˜µå¯ä»¥å°†æ•´ä¸ªæ¨¡å‹çš„é¢„æµ‹å’Œç³»æ•°ä¼°è®¡å‹ç¼©ä¸ºå‡ ä¸ªç®€æ´çš„æ•°å­¦å¼å­**ã€‚è¿™ç§è¡¨è¾¾æ–¹å¼ä¸ä»…ä¾¿äºç†è§£å’Œæ¨å¯¼ï¼Œè¿˜æ–¹ä¾¿äº†æ¨¡å‹çš„å®ç°å’Œåˆ†æã€‚

3. **æ³›åŒ–èƒ½åŠ›**

çŸ©é˜µè¡¨ç¤º**è®©æ¨¡å‹çš„æ¨å¹¿å˜å¾—æ›´åŠ å®¹æ˜“**ã€‚æ— è®ºæ˜¯å¢åŠ æ›´å¤šçš„è§‚æµ‹æ•°æ®ï¼Œè¿˜æ˜¯å¼•å…¥æ›´å¤šçš„è‡ªå˜é‡ï¼Œæ¨¡å‹çš„**æ ¸å¿ƒæ•°å­¦è¡¨è¾¾å½¢å¼ä¿æŒä¸å˜**ï¼Œåªéœ€è°ƒæ•´çŸ©é˜µçš„å¤§å°å³å¯ã€‚è¿™ç§çµæ´»æ€§ä½¿å¾—çŸ©é˜µè¡¨ç¤ºéå¸¸é€‚åˆå¤„ç†å„ç§è§„æ¨¡å’Œå¤æ‚åº¦çš„é—®é¢˜ã€‚

4. **ç†è®ºåˆ†æ**

åœ¨ç†è®ºåˆ†æå’Œè¯æ˜ä¸­ï¼ŒçŸ©é˜µè¡¨ç¤ºä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§å¼ºå¤§çš„å·¥å…·ã€‚å®ƒå…è®¸æˆ‘ä»¬ä½¿ç”¨çº¿æ€§ä»£æ•°çš„ç†è®ºæ¥ç ”ç©¶æ¨¡å‹çš„æ€§è´¨ï¼Œæ¯”å¦‚å¯è§£æ€§ã€ç¨³å®šæ€§å’Œæœ€ä¼˜æ€§ç­‰ã€‚é€šè¿‡çŸ©é˜µçš„ç‰¹å¾å€¼ã€å¥‡å¼‚å€¼ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥æ·±å…¥ç†è§£æ¨¡å‹çš„è¡Œä¸ºå’Œæ€§èƒ½é™åˆ¶ã€‚

5. **ç»Ÿä¸€çš„æ¡†æ¶**

çŸ©é˜µè¡¨ç¤ºä¸ºä¸åŒç±»å‹çš„æ•°æ®åˆ†æå’Œæœºå™¨å­¦ä¹ ç®—æ³•æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¡†æ¶ã€‚è®¸å¤šç®—æ³•ï¼Œæ— è®ºæ˜¯ç›‘ç£å­¦ä¹ è¿˜æ˜¯éç›‘ç£å­¦ä¹ ï¼Œéƒ½å¯ä»¥é€šè¿‡çŸ©é˜µå’Œå‘é‡æ¥è¡¨è¾¾ï¼Œè¿™æœ‰åŠ©äºåœ¨ä¸åŒç®—æ³•ä¹‹é—´å»ºç«‹è”ç³»ï¼Œä»¥åŠå°†ä¸€ç§ç®—æ³•çš„æ´å¯Ÿåº”ç”¨åˆ°å¦ä¸€ç§ç®—æ³•ä¸­ã€‚

6. **æ•°æ®ç»“æ„å¯¹åº”**

åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ•°æ®é€šå¸¸ä»¥è¡¨æ ¼å½¢å¼å­˜åœ¨ï¼Œå…¶ä¸­è¡Œä»£è¡¨è§‚æµ‹å€¼ï¼Œåˆ—ä»£è¡¨ç‰¹å¾ã€‚çŸ©é˜µè‡ªç„¶åœ°å¯¹åº”äºè¿™ç§æ•°æ®ç»“æ„ï¼Œä½¿å¾—æ•°æ®çš„å¤„ç†ã€å˜æ¢å’Œåˆ†ææ›´åŠ ç›´æ¥å’Œæ–¹ä¾¿ã€‚

æ ¸å¿ƒå°±ä¸»è¦é›†ä¸­åœ¨å‰ä¸‰ç‚¹ï¼Œæ‰€ä»¥åŸºäºä»¥ä¸ŠåŸå› ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨çŸ©é˜µæ¥è¿›è¡Œè¿ç®—ã€‚

##### ä¸ºäº†æ–¹ä¾¿åç»­å†…å®¹çš„ç†è§£ï¼Œå…ˆçœ‹ä¸‹é¢ä¸€ä¸ªå®ä¾‹ç†è§£ä¸€ä¸‹çŸ©é˜µï¼š

 å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå¤šå…ƒçº¿æ€§å›å½’é—®é¢˜ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå› å˜é‡ $Y$ï¼ˆæ¯”å¦‚æˆ¿å±‹ä»·æ ¼ï¼‰ï¼Œå’Œä¸¤ä¸ªè‡ªå˜é‡ $X_1$ï¼ˆæ¯”å¦‚æˆ¿å±‹çš„é¢ç§¯ï¼‰å’Œ $X_2$ï¼ˆæ¯”å¦‚æˆ¿å±‹çš„å¹´é¾„ï¼‰ã€‚æˆ‘ä»¬æœ‰3ä¸ªè§‚æµ‹å€¼ï¼Œç°åœ¨æˆ‘ä»¬ä½¿ç”¨çŸ©é˜µæ¥è¡¨ç¤ºè¿™ä¸ªå¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹ã€‚

##### è§‚æµ‹æ•°æ®

| è§‚æµ‹ | $Y$ (æˆ¿ä»·) | $X_1$ (é¢ç§¯) | $X_2$ (å¹´é¾„) |
| ---- | ---------- | ------------ | ------------ |
| 1    | 300        | 1000         | 5            |
| 2    | 400        | 1500         | 3            |
| 3    | 350        | 1200         | 4            |

##### çŸ©é˜µè¡¨ç¤º

åœ¨å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹ä¸­ï¼Œ**æˆ‘ä»¬é€šå¸¸åœ¨è‡ªå˜é‡çŸ©é˜µ $X$ ä¸­æ·»åŠ ä¸€åˆ—1æ¥ä»£è¡¨æˆªè·é¡¹ $\beta_0$**ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„çŸ©é˜µ $X$ å’Œå‘é‡ $Y$ å¯ä»¥è¡¨ç¤ºå¦‚ä¸‹ï¼š

- $Y$ = $\begin{bmatrix} 300 \\ 400 \\ 350 \end{bmatrix}$
- $X$ = $\begin{bmatrix} 1\space \space \space 1000\space \space \space 5 \\ 1\space \space \space 1500\space \space \space 3 \\ 1\space \space \space 1200\space \space \space 4 \end{bmatrix}$
  å…¶ä¸­ï¼Œ$X$ çŸ©é˜µçš„**ç¬¬ä¸€åˆ—æ˜¯å…¨1ï¼Œä»£è¡¨æˆªè·é¡¹ï¼Œç¬¬äºŒåˆ—æ˜¯è‡ªå˜é‡ $X_1$ çš„å€¼ï¼Œç¬¬ä¸‰åˆ—æ˜¯è‡ªå˜é‡ $X_2$â€‹ çš„å€¼ã€‚**

> ä¹‹æ‰€ä»¥ç¬¬ä¸€åˆ—è®¾ç½®ä¸ºæˆªè·é¡¹ï¼š
>
> æˆªè·é¡¹ $Î²_0$ ä»£è¡¨äº†å½“æ‰€æœ‰è‡ªå˜é‡ X çš„å€¼éƒ½ä¸º0æ—¶ï¼Œå› å˜é‡ Y çš„æœŸæœ›å€¼ã€‚åœ¨è®¸å¤šå®é™…æƒ…å†µä¸‹ï¼Œå³ä½¿æ‰€æœ‰çš„è‡ªå˜é‡éƒ½æ˜¯0ï¼Œå› å˜é‡ä¹Ÿå¯èƒ½ä¸ä¸º0ã€‚å› æ­¤ï¼Œæˆªè·é¡¹æ˜¯æ¨¡å‹çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå¯ä»¥æä¾›æ›´å®Œæ•´çš„æ•°æ®æ‹Ÿåˆã€‚

### 2.5 å…³äºæœ€å°åŒ–æŸå¤±æƒ…å†µä¸‹å‚æ•°æ±‚è§£å…¬å¼çš„æ¨å¯¼

##### æŸå¤±å‡½æ•°çš„çŸ©é˜µåŒ–è¡¨ç¤º

åœ¨çŸ©é˜µçš„å½¢å¼ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†æŸå¤±å‡½æ•° $S$ è¡¨ç¤ºä¸ºï¼š

$S = (Y - X\beta)^T(Y - X\beta)$

è¿™é‡Œï¼Œ

- $Y$ æ˜¯ä¸€ä¸ª $n \times 1$ çš„åˆ—å‘é‡ï¼ŒåŒ…å«äº†æ‰€æœ‰çš„å®é™…è§‚æµ‹å€¼ã€‚
- $X$ æ˜¯ä¸€ä¸ª $n \times (p+1)$ çš„è®¾è®¡çŸ©é˜µï¼ŒåŒ…å«äº†æ‰€æœ‰çš„è‡ªå˜é‡å€¼ä»¥åŠä¸€åˆ—å…¨1ï¼ˆå¯¹åº”æˆªè·é¡¹ï¼‰ã€‚
- $\beta$ æ˜¯ä¸€ä¸ª $(p+1) \times 1$ çš„åˆ—å‘é‡ï¼ŒåŒ…å«äº†æ¨¡å‹çš„æ‰€æœ‰ç³»æ•°ï¼ˆåŒ…æ‹¬æˆªè·é¡¹ï¼‰ã€‚
- $X\beta$â€‹â€‹ è¡¨ç¤ºæ¨¡å‹çš„é¢„æµ‹å€¼ã€‚

çŸ©é˜µXçš„æ¨¡å¼ï¼š

$X = \begin{bmatrix}
1 \space\space\space X_{11} \space\space\space X_{12} \space\space\space \dots \space\space\space X_{1n} \\
1 \space\space\space X_{21} \space\space\space X_{22} \space\space\space \dots \space\space\space X_{2n} \\
\vdots \space\space\space \vdots \space\space\space \vdots \space\space\space \ddots \space\space\space \vdots \\
1 \space\space\space X_{m1} \space\space\space X_{m2} \space\space\space \dots \space\space\space X_{mn}
\end{bmatrix}$

çŸ©é˜µ $\beta$çš„æ¨¡å¼ï¼š

$\beta = \begin{bmatrix}
\beta_0 \\
\beta_1 \\
\beta_2 \\
\vdots \\
\beta_p
\end{bmatrix}$

> ä¸ºäº†è¯¦ç»†è¯´æ˜ $X\beta$ çš„è¿ç®—è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å‰é¢çš„ä¾‹å­ä¸­çš„çŸ©é˜µ $X$ å’Œç³»æ•°å‘é‡ $\beta$ã€‚å‡
>
> è®¾æˆ‘ä»¬å·²ç»é€šè¿‡æŸç§æ–¹æ³•ï¼ˆä¾‹å¦‚æœ€å°äºŒä¹˜æ³•ï¼‰è®¡ç®—å‡ºäº† $\beta$ çš„ä¼°è®¡å€¼ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œ$\beta$ çš„ä¼°è®¡å€¼å¦‚ä¸‹ï¼š
>
> $\hat{\beta} = \begin{bmatrix} \beta_0 \\ \beta_1 \\ \beta_2 \end{bmatrix} = \begin{bmatrix} 550 \\ 0 \\ -50 \end{bmatrix}$
>
> $X$ çŸ©é˜µï¼ˆåŒ…å«æˆªè·é¡¹çš„è‡ªå˜é‡çŸ©é˜µï¼‰å¦‚ä¸‹ï¼š
>
> $X = \begin{bmatrix} 1 \space\space\space 1000 \space\space\space 5 \\ 1 \space\space\space 1500 \space\space\space 3 \\ 1 \space\space\space 1200 \space\space\space 4 \end{bmatrix}$
>
> ç°åœ¨ï¼Œæˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•è®¡ç®— $X\beta$ï¼š
>
> $X\beta = \begin{bmatrix} 1 \space\space\space 1000 \space\space\space 5 \\ 1 \space\space\space 1500 \space\space\space 3 \\ 1 \space\space\space 1200 \space\space\space 4 \end{bmatrix} \begin{bmatrix} 550 \\ 0 \\ -50 \end{bmatrix}$
>
> è¿™ä¸ªä¹˜æ³•æ“ä½œçš„ç»“æœæ˜¯ä¸€ä¸ªåˆ—å‘é‡ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ $X$ çš„æ¯ä¸€è¡Œä¸ $\beta$â€‹ çš„ç‚¹ç§¯ï¼ˆæˆ–è€…è¯´æ˜¯å†…ç§¯ï¼‰ã€‚
>
> ---
>
> ç„¶åå†è§£é‡Šä¸€ä¸‹ï¼ŒåŸæœ¬æˆ‘ä»¬çš„æŸå¤±å‡½æ•°ä¸ºï¼š
> $$
> S = \sum_{i=1}^{n} (y_i - \hat{y}_i)^2
> $$
> è½¬æ¢æˆçŸ©é˜µè¡¨ç¤ºå°±æ˜¯ï¼š
> $$
> S =  (Y - X\beta)^2
> $$
> **å› ä¸ºçŸ©é˜µåŒ…å«äº†æ‰€æœ‰çš„Xä¸Yï¼Œæ‰€ä»¥æ²¡å¿…è¦æ±‚å’Œ**ã€‚ä½†æ˜¯ä¸Šå¼æ˜¯ä¸ä¸€å®šèƒ½è¿ç®—çš„ï¼Œå› ä¸ºçŸ©é˜µè¿ç®—æœ‰**Aè¡ŒBåˆ—ä¸èƒ½ç›´æ¥Ã—Aè¡ŒBåˆ—ï¼Œè¦ä¹˜Båˆ—Aè¡Œï¼Œæ‰€ä»¥éœ€è¦è½¬ç½®ï¼š**
> $$
> S = (Y - X\beta)^T(Y - X\beta)
> $$

##### è½¬ç½®çš„è¿ç®—è§„åˆ™

å…ˆè®²ä¸€ä¸‹è½¬ç½®è¿ç®—çš„å¸¸ç”¨è§„åˆ™ï¼š

è¿™é‡Œæ˜¯ä¸€äº›åŸºæœ¬çš„è½¬ç½®è¿ç®—è§„åˆ™ï¼š

1. åŸºæœ¬å®šä¹‰

- è‹¥ $A$ æ˜¯ä¸€ä¸ª $m \times n$ çŸ©é˜µï¼Œé‚£ä¹ˆ $A$ çš„è½¬ç½®ï¼Œè®°ä½œ $A'$ æˆ– $A^T$ï¼Œæ˜¯ä¸€ä¸ª $n \times m$ çŸ©é˜µï¼Œå…¶å…ƒç´ æ»¡è¶³ï¼šå¦‚æœ $a_{ij}$ æ˜¯ $A$ ä¸­çš„å…ƒç´ ï¼ˆç¬¬ $i$ è¡Œï¼Œç¬¬ $j$ åˆ—ï¼‰ï¼Œé‚£ä¹ˆåœ¨ $A'$ ä¸­çš„å¯¹åº”å…ƒç´  $a'*{ji}$ï¼ˆç¬¬ $j$ è¡Œï¼Œç¬¬ $i$ åˆ—ï¼‰ç­‰äº $a*{ij}$ã€‚

2. è½¬ç½®çš„è½¬ç½®

- å¯¹ä»»æ„çŸ©é˜µ $A$ï¼Œ$(A')' = A$ã€‚è¿™æ„å‘³ç€å¦‚æœä½ å¯¹ä¸€ä¸ªçŸ©é˜µè¿›è¡Œä¸¤æ¬¡è½¬ç½®ï¼Œä½ ä¼šå›åˆ°åŸå§‹çŸ©é˜µã€‚

3. åŠ æ³•

- å¯¹äºä»»æ„ä¸¤ä¸ªåŒå‹çŸ©é˜µ $A$ å’Œ $B$ï¼Œ$(A + B)' = A' + B'$ã€‚è¿™æ„å‘³ç€ä¸¤ä¸ªçŸ©é˜µå…ˆåŠ åè½¬ç½®ï¼Œä¸å…ˆè½¬ç½®å†åŠ æ˜¯ç­‰ä»·çš„ã€‚

4. æ•°ä¹˜

- å¯¹äºä»»æ„çŸ©é˜µ $A$ å’Œä»»æ„æ ‡é‡ $k$ï¼Œ$(kA)' = kA'$ã€‚è¿™æ„å‘³ç€å¯ä»¥å…ˆå¯¹çŸ©é˜µè¿›è¡Œæ ‡é‡ä¹˜æ³•ï¼Œç„¶åè½¬ç½®ï¼Œæˆ–è€…å…ˆè½¬ç½®çŸ©é˜µå†è¿›è¡Œæ ‡é‡ä¹˜æ³•ï¼Œç»“æœæ˜¯ç›¸åŒçš„ã€‚

5. çŸ©é˜µä¹˜æ³•

- å¯¹äºä¸¤ä¸ªçŸ©é˜µ $A$ å’Œ $B$ï¼Œå…¶ä¸­ $A$ çš„åˆ—æ•°ç­‰äº $B$ çš„è¡Œæ•°ï¼Œé‚£ä¹ˆ $(AB)' = B'A'$ã€‚è¿™ä¸ªè§„åˆ™æŒ‡å‡ºï¼Œä¸¤ä¸ªçŸ©é˜µç›¸ä¹˜çš„ç»“æœçš„è½¬ç½®ç­‰äºå„è‡ªè½¬ç½®ååå‘ä¹˜çš„ç»“æœã€‚

6. é€†çŸ©é˜µçš„è½¬ç½®

- å¯¹äºä»»æ„å¯é€†çŸ©é˜µ $A$ï¼Œ$(A^{-1})' = (A')^{-1}$ã€‚è¿™æ„å‘³ç€çŸ©é˜µçš„é€†çš„è½¬ç½®ç­‰äºçŸ©é˜µçš„è½¬ç½®çš„é€†ã€‚

##### å‚æ•°æ ¹æ®æŸå¤±å‡½æ•°çš„æ¨å¯¼

åœ¨å¤šå…ƒçº¿æ€§å›å½’ä¸­ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰¾åˆ°ç³»æ•° $\beta$ çš„å€¼ï¼Œä½¿å¾—æŸå¤±å‡½æ•° $S$ çš„å€¼æœ€å°ã€‚**é€šè¿‡å¯¹ $S$ å…³äº $\beta$ æ±‚åå¯¼å¹¶è®¾ä¸º0ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä½¿ $S$ æœ€å°åŒ–çš„ $\beta$â€‹ çš„è§£æè§£**ï¼Œå³ï¼š
$$
S = (Y - X\beta)â€™(Y - X\beta)
$$

ä¸Šå¼å¯ä»¥è½¬åŒ–ä¸º

$S = Y'Y - Y'X\beta - \beta'X'Y + \beta'X'X\beta$â€‹

æ³¨æ„åˆ° $Y'X\beta$ æ˜¯**ä¸€ä¸ªæ•°ï¼ˆæ ‡é‡ï¼‰**ï¼Œå› æ­¤å®ƒç­‰äºå…¶è‡ªèº«çš„è½¬ç½®ï¼Œå³ $Y'X\beta = (Y'X\beta)' = \beta'X'Y$ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å°† $S$ ç®€åŒ–ä¸ºï¼š

$S = Y'Y - 2\beta'X'Y + \beta'X'X\beta$

**æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯¹ $\beta$ æ±‚åå¯¼**

è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ**$\beta'X'Y$ æ˜¯å…³äº $\beta$ çš„çº¿æ€§é¡¹ï¼Œè€Œ $\beta'X'X\beta$ æ˜¯å…³äº $\beta$ çš„äºŒæ¬¡é¡¹**ã€‚æ±‚åå¯¼æ•°æ—¶ï¼Œçº¿æ€§é¡¹çš„å¯¼æ•°æ˜¯å…¶ç³»æ•°ï¼ŒäºŒæ¬¡é¡¹çš„å¯¼æ•°åˆ™éœ€è¦åº”ç”¨é“¾å¼æ³•åˆ™ã€‚

> **è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä»¥ä¸‹çš„çŸ©é˜µå¾®åˆ†è§„åˆ™ï¼š**
>
> - å¯¹äºå½¢å¼ä¸º $\beta'X'Y$ çš„é¡¹ï¼Œå…¶å¯¹ $\beta$ çš„åå¯¼æ•°æ˜¯ $X'Y$ã€‚
> - å¯¹äºå½¢å¼ä¸º $\beta'X'X\beta$ çš„é¡¹ï¼Œå…¶å¯¹ $\beta$ çš„åå¯¼æ•°æ˜¯ $2X'X\beta$ã€‚

æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ï¼š

$\frac{\partial S}{\partial \beta} = -2X'Y + 2X'X\beta$â€‹

æ ¹æ®è¿™ä¸ªå…¬å¼å°±å¯ä»¥æ±‚å‡ºæ‰€æœ‰çš„ $\beta$â€‹ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªçŸ©é˜µã€‚

ä¸ºäº†æ‰¾åˆ°æœ€å°åŒ– $S$ çš„ $\beta$ å€¼ï¼Œæˆ‘ä»¬å°†**åå¯¼æ•°è®¾ç½®ä¸ºé›¶**ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªå…³äº $\beta$ çš„äºŒæ¬¡å‡½æ•°ï¼Œä¸”å¼€å£å‘ä¸Šï¼Œæ‰€ä»¥åå¯¼æ•°ä¸º0çš„åœ°æ–¹å°±æ˜¯å…¶æå°å€¼ï¼š

$-2X'Y + 2X'X\beta = 0$

æœ€åï¼Œæˆ‘ä»¬è§£è¿™ä¸ªæ–¹ç¨‹æ‰¾åˆ° $\beta$ï¼š

$2X'X\beta = 2X'Y$

ç®€åŒ–å¾—åˆ°ï¼š

$X'X\beta = X'Y$

å› æ­¤ï¼Œ$\beta$ çš„è§£æè§£æ˜¯ï¼š

$\beta = (X'X)^{-1}X'Y$

è¿™ä¸ªè§£ç»™å‡ºäº†ç³»æ•° $\beta$ çš„å€¼ï¼Œå®ƒæœ€å°åŒ–äº†æ®‹å·®å¹³æ–¹å’Œ $S$ã€‚

æ‰€ä»¥åœ¨ä»£ç å®ç°ä¸­æˆ‘ä»¬å°±å¯ä»¥æŒ‰ç…§å¦‚ä¸Šå…¬å¼ $\beta = (X'X)^{-1}X'Y$æ±‚å‡º**æ‰€æœ‰çš„æ–œç‡ $\beta_1 - \beta_n$ ä»¥åŠæˆªè· $\beta_0$ ã€‚**

æ¥ä¸‹æ¥æˆ‘ä¹ˆå°±æ¥è¿›è¡Œä»£ç å®ç°ã€‚

## 3. ä»£ç å®ç°

## 3.1 é—®é¢˜æè¿°

ç°åœ¨æœ‰å¦‚ä¸‹æ•°æ®ï¼š

| èº«é«˜(cm) | å¹´é¾„ï¼ˆå²ï¼‰ | æ€§åˆ« | ä½“é‡ï¼ˆkgï¼‰ |
| -------- | ---------- | ---- | ---------- |
| 170      | 30         | ç”·   | 75         |
| 160      | 45         | å¥³   | 65         |
| 180      | 25         | ç”·   | 85         |
| 165      | 35         | å¥³   | 70         |
| 175      | 40         | ç”·   | 80         |
| 155      | 50         | å¥³   | 60         |
| 185      | 28         | ç”·   | 90         |
| 168      | 32         | å¥³   | 68         |
| 172      | 37         | ç”·   | 78         |
| 163      | 42         | å¥³   | 72         |
| 178      | 29         | ç”·   | 83         |
| 167      | 31         | å¥³   | 66         |

ç°åœ¨æˆ‘ä»¬æœ‰12ä¸ªæ ·æœ¬æ•°æ®ã€‚æ¯ä¸ªæ ·æœ¬éƒ½åŒ…æ‹¬äº†**èº«é«˜ã€å¹´é¾„å’Œæ€§åˆ«è¿™ä¸‰ä¸ªè‡ªå˜é‡ï¼Œä»¥åŠç›¸åº”çš„ä½“é‡ä½œä¸ºå› å˜é‡**ã€‚è¦æ±‚é¢„æµ‹ç»™å®šèº«é«˜ã€å¹´é¾„å’Œæ€§åˆ«è¿™ä¸‰ä¸ªè‡ªå˜é‡åå…¶å¯¹åº”çš„ä½“é‡ï¼Ÿ

## 3.2 å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹

é€šè¿‡å‰é¢çš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹çš„å…³äº$\beta$çš„è®¡ç®—å…¬å¼ï¼š
$\beta = (X'X)^{-1}X'Y$
å…¶ä¸­ï¼ŒXæ˜¯è‡ªå˜é‡çš„çŸ©é˜µï¼ŒYæ˜¯å› å˜é‡çš„çŸ©é˜µã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå…¬å¼æ¥è®¡ç®—å‡ºå¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹çš„ç³»æ•°ã€‚
è¿™ä¸ªå…¬å¼ä¸­ï¼ŒX'æ˜¯Xçš„è½¬ç½®çŸ©é˜µï¼Œ$(X'X)^{-1}$æ˜¯X'Xçš„é€†çŸ©é˜µã€‚
å®ƒæ˜¯æ ¹æ®æœ€å°åŒ–è¯¯å·®å¹³æ–¹å’Œçš„åŸç†æ¨å¯¼å‡ºæ¥çš„ã€‚


```python
# ä»£ç å®ç°,å¯¼å…¥numpyåº“ï¼Œå®šä¹‰æ•°æ®
import numpy as np

X = np.array(
    [[170, 30, 1], [160, 45, 0], [180, 25, 1], [165, 35, 0], [175, 40, 1], [155, 50, 0], [185, 28, 1], [168, 32, 0],
     [172, 37, 1], [163, 42, 0], [178, 29, 1], [167, 31, 0]])
Y = np.array([75, 65, 85, 70, 80, 60, 90, 68, 78, 72, 83, 66])
```

## 3.3 å¯è§†åŒ–æ•°æ®


```python
from pyecharts import options as opts
from pyecharts.charts import Scatter3D

data = X.tolist()  # è½¬æ¢æ•°æ®ä¸ºåˆ—è¡¨æ ¼å¼
# åˆ›å»º3Dæ•£ç‚¹å›¾
scatter3D = Scatter3D(init_opts=opts.InitOpts(width="800px", height="600px"))
scatter3D.add("", data)
# è®¾ç½®3Dæ•£ç‚¹å›¾çš„å…¨å±€é€‰é¡¹
scatter3D.set_global_opts(
    title_opts=opts.TitleOpts(title="3D Scatter Plot"),
    visualmap_opts=opts.VisualMapOpts(
        max_=1,
        min_=0,
        range_color=["#313695", "#4575b4", "#74add1", "#abd9e9", "#e0f3f8", "#ffffbf", "#fee090", "#fdae61", "#f46d43",
                     "#d73027", "#a50026"],
    )
)
# ç›´æ¥åœ¨Jupyter Notebookä¸­æ˜¾ç¤ºå›¾è¡¨
scatter3D.render_notebook()
```

![image-20240303112218390](https://raw.githubusercontent.com/thisisbaiy/PicGo/main/202403031134862.png)


```python
print(X.shape[0], X.shape[1], type(X.shape[0]), type(X.shape[1]))
```

    12 3 <class 'int'> <class 'int'>

```python
# æ ¹æ®å…¬å¼è®¡ç®—betaï¼ˆå…¶ä¸­åŒ…æ‹¬æˆªè·é¡¹ï¼‰
def multi_linear_regression(X, Y):
    # np.hstack()æ˜¯å°†ä¸¤ä¸ªçŸ©é˜µæ°´å¹³åˆå¹¶ï¼Œæ¯”å¦‚ï¼š
    # np.hstack([np.array([[1, 2, 3]]), np.array([[4, 5, 6]])]) = np.array([[1, 2, 3, 4, 5, 6]])
    # è¿™é‡Œæ˜¯å°†XçŸ©é˜µçš„ç¬¬ä¸€åˆ—å…¨éƒ¨è®¾ç½®ä¸º1ï¼Œç”¨äºè®¡ç®—æˆªè·é¡¹ï¼ŒX.shape[0]æ˜¯XçŸ©é˜µçš„è¡Œæ•°
    X = np.hstack([np.ones((X.shape[0], 1)), X])
    # ------------------------------------------------
    # æ±‚è§£beta
    # np.linalg.inv()æ˜¯æ±‚çŸ©é˜µçš„é€†
    # np.dot()æ˜¯çŸ©é˜µä¹˜æ³•
    # np.transpose()æ˜¯çŸ©é˜µè½¬ç½®
    # \beta = (X'X)^{-1}X'Y
    # ------------------------------------------------
    beta = np.dot(np.dot(np.linalg.inv(np.dot(X.T, X)), X.T), Y)
    return beta
```


```python
# è®¡ç®—beta
beta = multi_linear_regression(X, Y)
print(beta)
```

    [-112.53822782    1.04161439    0.2448106     2.64148459]


## 3.4 å›å½’æ–¹ç¨‹ä¸º

Y = beta[0] + beta[1] * X1 + beta[2] * X2 + beta[3] * X3

å…¶ä¸­X1ã€X2ã€X3åˆ†åˆ«æ˜¯èº«é«˜ã€å¹´é¾„å’Œæ€§åˆ«

```python
print("å›å½’æ–¹ç¨‹ä¸ºï¼šY = {:.2f} + {:.2f} * X1 + {:.2f} * X2 + {:.2f} * X3".format(beta[0], beta[1], beta[2], beta[3]))
```

    å›å½’æ–¹ç¨‹ä¸ºï¼šY = -112.54 + 1.04 * X1 + 0.24 * X2 + 2.64 * X3


## 3.5 é¢„æµ‹


```python
# å‡è®¾è¦é¢„æµ‹çš„æ•°æ®ä¸ºï¼šèº«é«˜170cmï¼Œå¹´é¾„35å²ï¼Œæ€§åˆ«ç”·
X_test = np.array([170, 35, 1])
# é¢„æµ‹
Y_test = beta[0] + np.dot(X_test, beta[1:])
print("é¢„æµ‹çš„ä½“é‡ä¸ºï¼š{:.2f}kg".format(Y_test))
```

    é¢„æµ‹çš„ä½“é‡ä¸ºï¼š75.75kg

```python
# å‡è®¾è¦é¢„æµ‹çš„æ•°æ®ä¸ºï¼šèº«é«˜160cmï¼Œå¹´é¾„40å²ï¼Œæ€§åˆ«å¥³
X_test = np.array([160, 40, 0])
# é¢„æµ‹
Y_test = beta[0] + np.dot(X_test, beta[1:])
print("é¢„æµ‹çš„ä½“é‡ä¸ºï¼š{:.2f}kg".format(Y_test))
```

    é¢„æµ‹çš„ä½“é‡ä¸ºï¼š63.91kg


## 3.6 å¯è§†åŒ–å›å½’å¹³é¢â€”â€”å®é™…ä¸Šæ˜¯ä¸å¯è¡Œçš„

- ä¸ºäº†æ›´å¥½ç†è§£ä¸åŒä¸ªæ•°è‡ªå˜é‡çš„å›¾åƒï¼Œæˆ‘ä»¬åˆ†åˆ«ç»˜åˆ¶ä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹å’ŒäºŒå…ƒä¸€æ¬¡æ–¹ç¨‹çš„å›¾åƒï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£ã€‚


```python
# å¯¹äºä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹ 2x+1=0ï¼Œæˆ‘å°†å±•ç¤ºå®ƒåœ¨äºŒç»´åæ ‡ç³»ä¸­çš„ç›´çº¿å›¾
# å¯¹äºäºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ x+2yâˆ’3=0ï¼Œæˆ‘å°†å±•ç¤ºå®ƒåœ¨ä¸‰ç»´åæ ‡ç³»ä¸­çš„å¹³é¢å›¾
import matplotlib.pyplot as plt
import numpy as np

# è®¾ç½®å›¾åƒå¤§å°
plt.figure(figsize=(12, 6))
# å­å›¾1ï¼šä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹ 2x + 1 = 0
plt.subplot(1, 2, 1)
x = np.linspace(-10, 10, 400)
y = -0.5 * np.ones_like(x)  # è§£ä¸ºx = -1/2
plt.plot(x, y, label='2x + 1 = 0')
plt.title('one-variable linear equation')
plt.xlabel('x')
plt.ylabel('y')
plt.axhline(0, color='black', linewidth=0.5)
plt.axvline(0, color='black', linewidth=0.5)
plt.grid(color='gray', linestyle='--', linewidth=0.5)
plt.legend()
# å­å›¾2ï¼šäºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ x + 2y - 3 = 0
plt.subplot(1, 2, 2)
x = np.linspace(-10, 10, 400)
y = (3 - x) / 2
plt.plot(x, y, label='x + 2y - 3 = 0')
plt.title('two-variable linear equation')
plt.xlabel('x')
plt.ylabel('y')
plt.axhline(0, color='black', linewidth=0.5)
plt.axvline(0, color='black', linewidth=0.5)
plt.grid(color='gray', linestyle='--', linewidth=0.5)
plt.legend()

plt.tight_layout()
plt.show()
```

![image-20240303112314819](https://raw.githubusercontent.com/thisisbaiy/PicGo/main/202403031134761.png)

```python
#å‡è®¾åªæœ‰ä¸¤ä¸ªè‡ªå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ç»˜åˆ¶ä¸‰ç»´å›¾åƒ
import numpy as np
import matplotlib.pyplot as plt

# å®šä¹‰åŸå§‹æ•°æ®ç‚¹
X = np.array([
    [170, 30, 1], [160, 45, 0], [180, 25, 1], [165, 35, 0], [175, 40, 1], [155, 50, 0],
    [185, 28, 1], [168, 32, 0], [172, 37, 1], [163, 42, 0], [178, 29, 1], [167, 31, 0]
])
# å›å½’æ–¹ç¨‹çš„ç³»æ•°
coefficients = [-112.54, 1.04, 0.24, 2.64]
# ç”ŸæˆX1, X2çš„ç½‘æ ¼
x1_range = np.linspace(150, 190, 20)
x2_range = np.linspace(20, 50, 20)
X1, X2 = np.meshgrid(x1_range, x2_range)
# é‡æ–°è®¡ç®—å›å½’å¹³é¢çš„Yå€¼ï¼Œä¸è€ƒè™‘X3çš„å½±å“
Y_plane = coefficients[0] + coefficients[1] * X1 + coefficients[2] * X2
# åˆ›å»º3Då›¾
fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')
# ç»˜åˆ¶åŸå§‹æ•°æ®ç‚¹ï¼Œä½¿ç”¨X3å€¼æ”¹å˜é¢œè‰²
ax.scatter(X[:, 0], X[:, 1], X[:, 2], c=X[:, 2], cmap='coolwarm', marker='o')
# ç»˜åˆ¶å›å½’å¹³é¢
ax.plot_surface(X1, X2, Y_plane, color='b', alpha=0.3)
# è®¾ç½®åæ ‡è½´æ ‡ç­¾
ax.set_xlabel('X1')
ax.set_ylabel('X2')
ax.set_zlabel('Y')
plt.show()
```


![png](https://raw.githubusercontent.com/thisisbaiy/PicGo/main/202403031134562.png)


**ä½†æ˜¯æˆ‘ä»¬æœ‰ä¸‰ä¸ªè‡ªå˜é‡ï¼Œè¿™è¯´æ˜å®ƒæ„æˆçš„å›¾åƒæ˜¯ä¸€ä¸ªä¸‰ç»´çš„å›¾åƒï¼Œæˆ‘ä»¬æ— æ³•åœ¨äºŒç»´å¹³é¢ä¸Šå±•ç¤ºå‡ºæ¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡å›¾åƒæ¥ç›´è§‚åœ°ç†è§£å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹ã€‚**

## 3.7 æ¨¡å‹è¯„ä¼°â€”â€”é‡‡ç”¨å†³å®šç³»æ•°Ræ–¹

è®¡ç®—å…¬å¼ä¸ºï¼š
$R^2 = 1 - \frac{\sum_{i=1}^{n}(Y_i - \hat{Y_i})^2}{\sum_{i=1}^{n}(Y_i - \bar{Y})^2}$
å…¶ä¸­ï¼Œ$Y_i$æ˜¯çœŸå®å€¼ï¼Œ$\hat{Y_i}$æ˜¯é¢„æµ‹å€¼ï¼Œ$\bar{Y}$æ˜¯çœŸå®å€¼çš„å‡å€¼ã€‚  
Ræ–¹çš„å–å€¼èŒƒå›´æ˜¯0åˆ°1ï¼ŒRæ–¹è¶Šæ¥è¿‘1ï¼Œè¯´æ˜æ¨¡å‹çš„æ‹Ÿåˆæ•ˆæœè¶Šå¥½ã€‚



```python
# é¢„æµ‹
Y_pred = beta[0] + np.dot(X, beta[1:])
print(Y_pred)
```

    [74.52202148 65.136552   83.71411239 67.89651794 82.17819947 61.15253305
     89.65661616 70.28692931 78.31892448 67.52696337 82.61012602 69.00050432]

```python
# è®¡ç®—Ræ–¹
def r2_score(Y, Y_pred):
    return 1 - np.sum((Y - Y_pred) ** 2) / np.sum((Y - np.mean(Y)) ** 2)
r2 = r2_score(Y, Y_pred)
print("Ræ–¹ä¸ºï¼š{:.2f}".format(r2))
```

    Ræ–¹ä¸ºï¼š0.95


## 3.8 æ€»ç»“

- å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹æ˜¯ä¸€ç§å¤šå…ƒçº¿æ€§æ–¹ç¨‹ï¼Œå®ƒæ˜¯é€šè¿‡å¤šä¸ªè‡ªå˜é‡æ¥é¢„æµ‹å› å˜é‡çš„ä¸€ç§æ¨¡å‹ã€‚
- é€šè¿‡ç»“æœæ¥çœ‹ï¼Œå¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹çš„Ræ–¹ä¸º0.95ï¼Œè¯´æ˜æ¨¡å‹çš„æ‹Ÿåˆæ•ˆæœè¿˜æ˜¯éå¸¸å¥½çš„ğŸ˜‚

